<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
<script>
  var kv = ["routerAddr","routeType","routeTypeVal","routeBindingPort","appName"];
  var tabs = ["home","settings","dashboard","input"];

  var activeTab = "home";

  $(document).ready(function() {
    // clear cookies
    for (i = 0; i < kv.length; i++) {
      createCookie(kv[i],"",-1);
    }
    $("#homeDiv").load("/home.md"); // load the contents of the home div

    clickTab(document.getElementById("settings"));

    console.log("Initialization complete.");
  });

  function createCookie(name,value,days) {
    var date = new Date();
    date.setTime(date.getTime()+(days*24*60*60*1000));

    var expires = "; expires="+date.toGMTString();

    document.cookie = name+"="+value+expires+"; path=/";
  }

  var urlsToLoad = [];
  var urlsIndex = 0;

  function goToNextURL() {
    if (urlsIndex < urlsToLoad.length) {
      console.log("Loading urlsToLoad[" + urlsIndex + "] --> " + urlsToLoad[urlsIndex]);
      document.getElementById('win1').src = urlsToLoad[urlsIndex];
      urlsIndex++;
    } else {
      if (document.getElementById("continuousLoop").checked) {
        urlsIndex = 0;
        fireTimer();
      } else {
        urlsToLoad = [];
        urlsIndex = 0;
        console.log("goToNextURL() is done.");
      }
    }
  }

  function saveChanges() {
    for (i = 0; i < kv.length; i++) {
      createCookie(kv[i],document.getElementById(kv[i]).value,1);
    }
  }

  function fireTimer() {
    setTimeout(goToNextURL, 100);
  }

  function startRequests() {
    //document.getElementById("startButton").value = "Stop";
    //document.getElementById("startButton").onclick = "alert();";
    line = document.getElementById("inputTextarea").value;
    urlsToLoad = line.split("\n");
    console.log("URLs loaded: " + urlsToLoad.length + ", continuousLoop: " + document.getElementById("continuousLoop").checked);
  
    document.getElementById("win1").addEventListener("load", fireTimer, false);
    fireTimer();
  }

  function stopRequests() {
    urlsToLoad = [];
  }

  function clickTab(obj) {
    console.log(obj.id + " click detected.");
    if (activeTab != obj.id) {
      console.log("New tab \"" + obj.id + "\" selected.");
      activeTab = obj.id;

      $('#headerRow').children('td').each(function () {
        if (this.id != "") {
          console.log("this.id = " + this.id);
          divName = this.id + "Div";
          if (this.id == activeTab) {
            this.className = "selected";
            document.getElementById(divName).style.display = "inline";
	  } else {
            this.className = "notSelected";
            document.getElementById(divName).style.display = "none";
          }
        }
      });
    }
  }
</script>
<style>
  body {
    font-family: "Arial", sans-serif;
    margin: 0px;
  }
  input, select {
    font-size: 14pt;
  }
  .selected {
    border: 1px solid black;
    border-bottom: none;
    cursor: default;
    padding: 10px;
  }
  .notSelected {
    border: 1px solid black;
    cursor: pointer;
    padding: 10px;
  }
</style>
</head>
<body>

<!-- HEADER -->
<img height=40 style="margin:10px;" src="/img/logo.png"/>
<div id=headerDiv>
<table width="100%" style="margin:0px;padding:0px;border-spacing:0px;">
<tr id=headerRow>
  <td style="border-bottom: 1px solid black;">&nbsp;</td>
  <td id=home onclick="clickTab(this);"><spa>Home</span></td>
  <td style="border-bottom: 1px solid black;"><img src="/img/1x1.png"/></td>
  <td id=settings onclick="clickTab(this);"><span>Settings</span></td>
  <td style="border-bottom: 1px solid black;"><img src="/img/1x1.png"/></td>
  <td id=dashboard onclick="clickTab(this);"><span>Dashboard</span></td>
  <td style="border-bottom: 1px solid black;"><img src="/img/1x1.png"/></td>
  <td id=input onclick="clickTab(this);"><span>Input</span></td>
  <td width="100%" style="border-bottom: 1px solid black;"></td>
</tr>
</table>
</div>

<!-- HOME TAB -->
<div style="margin:10px;">
<div id=homeDiv>
</div>

<!-- SETTINGS TAB -->
<div id=settingsDiv>
<table border=1 cellpadding=5 cellspacing=4>
<tr><td>Router Address:</td><td><input id=routerAddr type=text value="http://localhost:8080"/></td></tr>
<tr><td>App Name:</td><td><input id=appName type=text value="demo"/></td></tr>
<tr><td>Route Type:</td><td><select id=routeType><option value="ManagedContainer">Managed Container</option><option value="URL">URL</option>></td></tr>
<tr><td>Route Type Value:</td><td><input id=routeTypeVal type=text value=""/></td></tr>
<tr><td>Route Binding Port:</td><td><input id=routeBindingPort type=text value="8080"/></td></tr>
</table>
<input type=button onclick="saveChanges();" value="Save Changes"/>
</div>

<!-- INPUT TAB -->
<div id=inputDiv style="display:none;">
<textarea id=inputTextarea rows=4 cols=50>/helloworld.htm</textarea>
</div>

<!-- DASHBOARD TAB -->
<div id=dashboardDiv>
<input type=button id=startButton onclick="startRequests();" value="Start"/>
<input type=button id=stopButton onclick="stopRequests();" value="Stop"/>
<br/>
<input type="checkbox" id="continuousLoop" value=true checked>Loop continuously<br>
<p/>
<iframe id=win1 width=800 height=600></iframe>
<!-- <iframe src="http://192.168.84.130:5601/app/kibana#/visualize/edit/all-logs?embed=true&_g=(refreshInterval:(display:'10%20seconds',pause:!f,section:1,value:10000),time:(from:now-15m,mode:quick,to:now))&_a=(filters:!(),linked:!f,query:(query_string:(analyze_wildcard:!t,query:'*')),uiState:(),vis:(aggs:!((id:'1',params:(),schema:metric,type:count),(id:'2',params:(customInterval:'2h',extended_bounds:(),field:'@timestamp',interval:auto,min_doc_count:1),schema:segment,type:date_histogram)),listeners:(),params:(addLegend:!t,addTimeMarker:!f,addTooltip:!t,defaultYExtents:!f,mode:stacked,scale:linear,setYExtents:!f,shareYAxis:!t,times:!(),yAxis:()),title:'all%20logs',type:histogram))" height="600" width="800"></iframe> -->
</div>

<div id=outputDiv style="display:none;">
</div>

</div>
</body>
</html>
